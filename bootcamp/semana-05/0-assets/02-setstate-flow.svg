<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 800 500">
  <defs>
    <linearGradient id="stateGrad" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" style="stop-color:#CE93D8;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#7B1FA2;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="buildGrad" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" style="stop-color:#64B5F6;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#1976D2;stop-opacity:1" />
    </linearGradient>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#FFB74D"/>
    </marker>
  </defs>
  
  <!-- Background -->
  <rect width="800" height="500" fill="#1E1E1E"/>
  
  <!-- Title -->
  <text x="400" y="35" font-family="Arial, sans-serif" font-size="24" font-weight="bold" fill="#FFFFFF" text-anchor="middle">
    2. Flujo de setState()
  </text>
  <text x="400" y="58" font-family="Arial, sans-serif" font-size="14" fill="#B0B0B0" text-anchor="middle">
    Ciclo de actualizaci√≥n del estado local
  </text>
  
  <!-- Step 1: User Action -->
  <rect x="50" y="90" width="140" height="80" rx="10" fill="#2D2D2D" stroke="#FFB74D" stroke-width="2"/>
  <text x="120" y="115" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#FFB74D" text-anchor="middle">1. Acci√≥n</text>
  <text x="120" y="135" font-family="Arial, sans-serif" font-size="11" fill="#FFFFFF" text-anchor="middle">Usuario toca</text>
  <text x="120" y="150" font-family="monospace" font-size="10" fill="#B0B0B0" text-anchor="middle">onPressed()</text>
  
  <!-- Arrow 1-2 -->
  <line x1="190" y1="130" x2="250" y2="130" stroke="#FFB74D" stroke-width="2" marker-end="url(#arrowhead)"/>
  
  <!-- Step 2: setState -->
  <rect x="260" y="90" width="140" height="80" rx="10" fill="url(#stateGrad)"/>
  <text x="330" y="115" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#FFFFFF" text-anchor="middle">2. setState()</text>
  <text x="330" y="135" font-family="monospace" font-size="10" fill="#FFFFFF" text-anchor="middle">setState(() {</text>
  <text x="330" y="150" font-family="monospace" font-size="10" fill="#FFFFFF" text-anchor="middle">  _count++;</text>
  <text x="330" y="165" font-family="monospace" font-size="10" fill="#FFFFFF" text-anchor="middle">});</text>
  
  <!-- Arrow 2-3 -->
  <line x1="400" y1="130" x2="460" y2="130" stroke="#FFB74D" stroke-width="2" marker-end="url(#arrowhead)"/>
  
  <!-- Step 3: Mark Dirty -->
  <rect x="470" y="90" width="140" height="80" rx="10" fill="#2D2D2D" stroke="#EF5350" stroke-width="2"/>
  <text x="540" y="115" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#EF5350" text-anchor="middle">3. Marca "dirty"</text>
  <text x="540" y="135" font-family="Arial, sans-serif" font-size="11" fill="#FFFFFF" text-anchor="middle">Flutter agenda</text>
  <text x="540" y="150" font-family="Arial, sans-serif" font-size="11" fill="#FFFFFF" text-anchor="middle">rebuild</text>
  
  <!-- Arrow 3-4 -->
  <line x1="610" y1="130" x2="670" y2="130" stroke="#FFB74D" stroke-width="2" marker-end="url(#arrowhead)"/>
  
  <!-- Step 4: build() -->
  <rect x="680" y="90" width="100" height="80" rx="10" fill="url(#buildGrad)"/>
  <text x="730" y="120" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#FFFFFF" text-anchor="middle">4. build()</text>
  <text x="730" y="145" font-family="Arial, sans-serif" font-size="11" fill="#FFFFFF" text-anchor="middle">Re-render</text>
  
  <!-- Code Example Box -->
  <rect x="50" y="200" width="350" height="250" rx="8" fill="#2D2D2D" stroke="#404040" stroke-width="1"/>
  <text x="225" y="225" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#81C784" text-anchor="middle">Ejemplo Completo</text>
  
  <text x="70" y="255" font-family="monospace" font-size="11" fill="#CE93D8">class</text>
  <text x="105" y="255" font-family="monospace" font-size="11" fill="#64B5F6"> _CounterState</text>
  <text x="220" y="255" font-family="monospace" font-size="11" fill="#CE93D8"> extends</text>
  <text x="280" y="255" font-family="monospace" font-size="11" fill="#64B5F6"> State</text>
  <text x="312" y="255" font-family="monospace" font-size="11" fill="#FFFFFF"> {</text>
  
  <text x="80" y="275" font-family="monospace" font-size="11" fill="#CE93D8">int</text>
  <text x="105" y="275" font-family="monospace" font-size="11" fill="#FFFFFF"> _count =</text>
  <text x="175" y="275" font-family="monospace" font-size="11" fill="#FFB74D"> 0</text>
  <text x="185" y="275" font-family="monospace" font-size="11" fill="#FFFFFF">;</text>
  
  <text x="80" y="305" font-family="monospace" font-size="11" fill="#CE93D8">void</text>
  <text x="115" y="305" font-family="monospace" font-size="11" fill="#81C784"> _increment</text>
  <text x="200" y="305" font-family="monospace" font-size="11" fill="#FFFFFF">() {</text>
  
  <text x="90" y="325" font-family="monospace" font-size="11" fill="#FFB74D">setState</text>
  <text x="155" y="325" font-family="monospace" font-size="11" fill="#FFFFFF">(() =&gt; _count++);</text>
  
  <text x="80" y="345" font-family="monospace" font-size="11" fill="#FFFFFF">}</text>
  
  <text x="80" y="375" font-family="monospace" font-size="11" fill="#FFFFFF">@override</text>
  <text x="80" y="395" font-family="monospace" font-size="11" fill="#64B5F6">Widget</text>
  <text x="125" y="395" font-family="monospace" font-size="11" fill="#81C784"> build</text>
  <text x="165" y="395" font-family="monospace" font-size="11" fill="#FFFFFF">(context) =&gt;</text>
  
  <text x="90" y="415" font-family="monospace" font-size="11" fill="#64B5F6">Text</text>
  <text x="120" y="415" font-family="monospace" font-size="11" fill="#FFFFFF">('$_count');</text>
  
  <text x="70" y="435" font-family="monospace" font-size="11" fill="#FFFFFF">}</text>
  
  <!-- Warning Box -->
  <rect x="430" y="200" width="340" height="120" rx="8" fill="#2D2D2D" stroke="#EF5350" stroke-width="2"/>
  <text x="600" y="225" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#EF5350" text-anchor="middle">‚ö†Ô∏è Reglas Importantes</text>
  
  <text x="450" y="250" font-family="Arial, sans-serif" font-size="12" fill="#FFFFFF">‚ùå No llamar setState en build()</text>
  <text x="450" y="270" font-family="Arial, sans-serif" font-size="12" fill="#FFFFFF">‚ùå No llamar setState despu√©s de dispose()</text>
  <text x="450" y="290" font-family="Arial, sans-serif" font-size="12" fill="#FFFFFF">‚úÖ Solo modificar estado dentro del callback</text>
  <text x="450" y="310" font-family="Arial, sans-serif" font-size="12" fill="#FFFFFF">‚úÖ Mantener operaciones s√≠ncronas</text>
  
  <!-- Performance Tip -->
  <rect x="430" y="340" width="340" height="110" rx="8" fill="#2D2D2D" stroke="#81C784" stroke-width="2"/>
  <text x="600" y="365" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#81C784" text-anchor="middle">üí° Tip de Rendimiento</text>
  
  <text x="450" y="395" font-family="Arial, sans-serif" font-size="12" fill="#FFFFFF">setState reconstruye TODO el widget.</text>
  <text x="450" y="415" font-family="Arial, sans-serif" font-size="12" fill="#FFFFFF">Para widgets grandes, considera:</text>
  <text x="450" y="435" font-family="monospace" font-size="11" fill="#64B5F6">‚Ä¢ Extraer widgets m√°s peque√±os</text>
  
  <!-- Footer -->
  <text x="400" y="480" font-family="Arial, sans-serif" font-size="12" fill="#B0B0B0" text-anchor="middle">
    setState es s√≠ncrono pero el rebuild ocurre en el siguiente frame
  </text>
</svg>